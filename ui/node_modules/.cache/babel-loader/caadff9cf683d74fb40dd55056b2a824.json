{"ast":null,"code":"import _classCallCheck from \"/root/Pokemon/ui/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/root/Pokemon/ui/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _possibleConstructorReturn from \"/root/Pokemon/ui/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js\";\nimport _assertThisInitialized from \"/root/Pokemon/ui/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/root/Pokemon/ui/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/root/Pokemon/ui/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nimport $ from '../../shared/dom7.js';\nimport { extend, deleteProps } from '../../shared/utils.js';\nimport Framework7Class from '../../shared/class.js';\n/** @jsx $jsx */\n\nimport $jsx from '../../shared/$jsx.js';\n\nvar Messages = /*#__PURE__*/function (_Framework7Class) {\n  _inherits(Messages, _Framework7Class);\n\n  var _super = _createSuper(Messages);\n\n  function Messages(app, params) {\n    var _this;\n\n    _classCallCheck(this, Messages);\n\n    if (params === void 0) {\n      params = {};\n    }\n\n    _this = _super.call(this, params, [app]);\n\n    var m = _assertThisInitialized(_this);\n\n    var defaults = {\n      autoLayout: true,\n      messages: [],\n      newMessagesFirst: false,\n      scrollMessages: true,\n      scrollMessagesOnEdge: true,\n      firstMessageRule: undefined,\n      lastMessageRule: undefined,\n      tailMessageRule: undefined,\n      sameNameMessageRule: undefined,\n      sameHeaderMessageRule: undefined,\n      sameFooterMessageRule: undefined,\n      sameAvatarMessageRule: undefined,\n      customClassMessageRule: undefined,\n      renderMessage: undefined\n    }; // Extend defaults with modules params\n\n    m.useModulesParams(defaults);\n    m.params = extend(defaults, params);\n    var $el = $(params.el).eq(0);\n    if ($el.length === 0) return _possibleConstructorReturn(_this, m);\n    if ($el[0].f7Messages) return _possibleConstructorReturn(_this, $el[0].f7Messages);\n    $el[0].f7Messages = m;\n    var $pageContentEl = $el.closest('.page-content').eq(0);\n    extend(m, {\n      messages: m.params.messages,\n      $el: $el,\n      el: $el[0],\n      $pageContentEl: $pageContentEl,\n      pageContentEl: $pageContentEl[0]\n    }); // Install Modules\n\n    m.useModules(); // Init\n\n    m.init();\n    return _possibleConstructorReturn(_this, m);\n  } // eslint-disable-next-line\n\n\n  _createClass(Messages, [{\n    key: \"getMessageData\",\n    value: function getMessageData(messageEl) {\n      var $messageEl = $(messageEl);\n      var data = {\n        name: $messageEl.find('.message-name').html(),\n        header: $messageEl.find('.message-header').html(),\n        textHeader: $messageEl.find('.message-text-header').html(),\n        textFooter: $messageEl.find('.message-text-footer').html(),\n        footer: $messageEl.find('.message-footer').html(),\n        isTitle: $messageEl.hasClass('messages-title'),\n        type: $messageEl.hasClass('message-sent') ? 'sent' : 'received',\n        text: $messageEl.find('.message-text').html(),\n        image: $messageEl.find('.message-image').html(),\n        imageSrc: $messageEl.find('.message-image img').attr('src'),\n        typing: $messageEl.hasClass('message-typing')\n      };\n\n      if (data.isTitle) {\n        data.text = $messageEl.html();\n      }\n\n      if (data.text && data.textHeader) {\n        data.text = data.text.replace(\"<div class=\\\"message-text-header\\\">\".concat(data.textHeader, \"</div>\"), '');\n      }\n\n      if (data.text && data.textFooter) {\n        data.text = data.text.replace(\"<div class=\\\"message-text-footer\\\">\".concat(data.textFooter, \"</div>\"), '');\n      }\n\n      var avatar = $messageEl.find('.message-avatar').css('background-image');\n      if (avatar === 'none' || avatar === '') avatar = undefined;\n\n      if (avatar && typeof avatar === 'string') {\n        avatar = avatar.replace('url(', '').replace(')', '').replace(/\"/g, '').replace(/'/g, '');\n      } else {\n        avatar = undefined;\n      }\n\n      data.avatar = avatar;\n      return data;\n    }\n  }, {\n    key: \"getMessagesData\",\n    value: function getMessagesData() {\n      var m = this;\n      var data = [];\n      m.$el.find('.message, .messages-title').each(function (messageEl) {\n        data.push(m.getMessageData(messageEl));\n      });\n      return data;\n    }\n  }, {\n    key: \"renderMessage\",\n    value: function renderMessage(messageToRender) {\n      var m = this;\n      var message = extend({\n        type: 'sent',\n        attrs: {}\n      }, messageToRender);\n\n      if (m.params.renderMessage) {\n        return m.params.renderMessage.call(m, message);\n      }\n\n      if (message.isTitle) {\n        return \"<div class=\\\"messages-title\\\">\".concat(message.text, \"</div>\");\n      }\n\n      return $jsx(\"div\", _extends({\n        class: \"message message-\".concat(message.type, \" \").concat(message.isTyping ? 'message-typing' : '', \" \").concat(message.cssClass || '')\n      }, message.attrs), message.avatar && $jsx(\"div\", {\n        class: \"message-avatar\",\n        style: \"background-image:url(\".concat(message.avatar, \")\")\n      }), $jsx(\"div\", {\n        class: \"message-content\"\n      }, message.name && $jsx(\"div\", {\n        class: \"message-name\"\n      }, message.name), message.header && $jsx(\"div\", {\n        class: \"message-header\"\n      }, message.header), $jsx(\"div\", {\n        class: \"message-bubble\"\n      }, message.textHeader && $jsx(\"div\", {\n        class: \"message-text-header\"\n      }, message.textHeader), message.image && $jsx(\"div\", {\n        class: \"message-image\"\n      }, message.image), message.imageSrc && !message.image && $jsx(\"div\", {\n        class: \"message-image\"\n      }, $jsx(\"img\", {\n        src: message.imageSrc\n      })), (message.text || message.isTyping) && $jsx(\"div\", {\n        class: \"message-text\"\n      }, message.text || '', message.isTyping && $jsx(\"div\", {\n        class: \"message-typing-indicator\"\n      }, $jsx(\"div\", null), $jsx(\"div\", null), $jsx(\"div\", null))), message.textFooter && $jsx(\"div\", {\n        class: \"message-text-footer\"\n      }, message.textFooter)), message.footer && $jsx(\"div\", {\n        class: \"message-footer\"\n      }, message.footer)));\n    }\n  }, {\n    key: \"renderMessages\",\n    value: function renderMessages(messagesToRender, method) {\n      if (messagesToRender === void 0) {\n        messagesToRender = this.messages;\n      }\n\n      if (method === void 0) {\n        method = this.params.newMessagesFirst ? 'prepend' : 'append';\n      }\n\n      var m = this;\n      var html = messagesToRender.map(function (message) {\n        return m.renderMessage(message);\n      }).join('');\n      m.$el[method](html);\n    }\n  }, {\n    key: \"isFirstMessage\",\n    value: function isFirstMessage() {\n      var _m$params;\n\n      var m = this;\n      if (m.params.firstMessageRule) return (_m$params = m.params).firstMessageRule.apply(_m$params, arguments);\n      return false;\n    }\n  }, {\n    key: \"isLastMessage\",\n    value: function isLastMessage() {\n      var _m$params2;\n\n      var m = this;\n      if (m.params.lastMessageRule) return (_m$params2 = m.params).lastMessageRule.apply(_m$params2, arguments);\n      return false;\n    }\n  }, {\n    key: \"isTailMessage\",\n    value: function isTailMessage() {\n      var _m$params3;\n\n      var m = this;\n      if (m.params.tailMessageRule) return (_m$params3 = m.params).tailMessageRule.apply(_m$params3, arguments);\n      return false;\n    }\n  }, {\n    key: \"isSameNameMessage\",\n    value: function isSameNameMessage() {\n      var _m$params4;\n\n      var m = this;\n      if (m.params.sameNameMessageRule) return (_m$params4 = m.params).sameNameMessageRule.apply(_m$params4, arguments);\n      return false;\n    }\n  }, {\n    key: \"isSameHeaderMessage\",\n    value: function isSameHeaderMessage() {\n      var _m$params5;\n\n      var m = this;\n      if (m.params.sameHeaderMessageRule) return (_m$params5 = m.params).sameHeaderMessageRule.apply(_m$params5, arguments);\n      return false;\n    }\n  }, {\n    key: \"isSameFooterMessage\",\n    value: function isSameFooterMessage() {\n      var _m$params6;\n\n      var m = this;\n      if (m.params.sameFooterMessageRule) return (_m$params6 = m.params).sameFooterMessageRule.apply(_m$params6, arguments);\n      return false;\n    }\n  }, {\n    key: \"isSameAvatarMessage\",\n    value: function isSameAvatarMessage() {\n      var _m$params7;\n\n      var m = this;\n      if (m.params.sameAvatarMessageRule) return (_m$params7 = m.params).sameAvatarMessageRule.apply(_m$params7, arguments);\n      return false;\n    }\n  }, {\n    key: \"isCustomClassMessage\",\n    value: function isCustomClassMessage() {\n      var _m$params8;\n\n      var m = this;\n      if (m.params.customClassMessageRule) return (_m$params8 = m.params).customClassMessageRule.apply(_m$params8, arguments);\n      return undefined;\n    }\n  }, {\n    key: \"layout\",\n    value: function layout() {\n      var m = this;\n      m.$el.find('.message, .messages-title').each(function (messageEl, index) {\n        var $messageEl = $(messageEl);\n\n        if (!m.messages) {\n          m.messages = m.getMessagesData();\n        }\n\n        var classes = [];\n        var message = m.messages[index];\n        var previousMessage = m.messages[index - 1];\n        var nextMessage = m.messages[index + 1];\n\n        if (m.isFirstMessage(message, previousMessage, nextMessage)) {\n          classes.push('message-first');\n        }\n\n        if (m.isLastMessage(message, previousMessage, nextMessage)) {\n          classes.push('message-last');\n        }\n\n        if (m.isTailMessage(message, previousMessage, nextMessage)) {\n          classes.push('message-tail');\n        }\n\n        if (m.isSameNameMessage(message, previousMessage, nextMessage)) {\n          classes.push('message-same-name');\n        }\n\n        if (m.isSameHeaderMessage(message, previousMessage, nextMessage)) {\n          classes.push('message-same-header');\n        }\n\n        if (m.isSameFooterMessage(message, previousMessage, nextMessage)) {\n          classes.push('message-same-footer');\n        }\n\n        if (m.isSameAvatarMessage(message, previousMessage, nextMessage)) {\n          classes.push('message-same-avatar');\n        }\n\n        var customMessageClasses = m.isCustomClassMessage(message, previousMessage, nextMessage);\n\n        if (customMessageClasses && customMessageClasses.length) {\n          if (typeof customMessageClasses === 'string') {\n            customMessageClasses = customMessageClasses.split(' ');\n          }\n\n          customMessageClasses.forEach(function (customClass) {\n            classes.push(customClass);\n          });\n        }\n\n        $messageEl.removeClass('message-first message-last message-tail message-same-name message-same-header message-same-footer message-same-avatar');\n        classes.forEach(function (className) {\n          $messageEl.addClass(className);\n        });\n      });\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      var m = this;\n      m.messages = [];\n      m.$el.html('');\n    }\n  }, {\n    key: \"removeMessage\",\n    value: function removeMessage(messageToRemove, layout) {\n      if (layout === void 0) {\n        layout = true;\n      }\n\n      var m = this; // Index or El\n\n      var index;\n      var $el;\n\n      if (typeof messageToRemove === 'number') {\n        index = messageToRemove;\n        $el = m.$el.find('.message, .messages-title').eq(index);\n      } else if (m.messages && m.messages.indexOf(messageToRemove) >= 0) {\n        index = m.messages.indexOf(messageToRemove);\n        $el = m.$el.children().eq(index);\n      } else {\n        $el = $(messageToRemove);\n        index = $el.index();\n      }\n\n      if ($el.length === 0) {\n        return m;\n      }\n\n      $el.remove();\n      m.messages.splice(index, 1);\n      if (m.params.autoLayout && layout) m.layout();\n      return m;\n    }\n  }, {\n    key: \"removeMessages\",\n    value: function removeMessages(messagesToRemove, layout) {\n      if (layout === void 0) {\n        layout = true;\n      }\n\n      var m = this;\n\n      if (Array.isArray(messagesToRemove)) {\n        var messagesToRemoveEls = [];\n        messagesToRemove.forEach(function (messageToRemoveIndex) {\n          messagesToRemoveEls.push(m.$el.find('.message, .messages-title').eq(messageToRemoveIndex));\n        });\n        messagesToRemoveEls.forEach(function (messageToRemove) {\n          m.removeMessage(messageToRemove, false);\n        });\n      } else {\n        $(messagesToRemove).each(function (messageToRemove) {\n          m.removeMessage(messageToRemove, false);\n        });\n      }\n\n      if (m.params.autoLayout && layout) m.layout();\n      return m;\n    }\n  }, {\n    key: \"addMessage\",\n    value: function addMessage() {\n      var m = this;\n      var messageToAdd;\n      var animate;\n      var method;\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      if (typeof args[1] === 'boolean') {\n        messageToAdd = args[0];\n        animate = args[1];\n        method = args[2];\n      } else {\n        messageToAdd = args[0];\n        method = args[1];\n        animate = args[2];\n      }\n\n      if (typeof animate === 'undefined') {\n        animate = true;\n      }\n\n      if (typeof method === 'undefined') {\n        method = m.params.newMessagesFirst ? 'prepend' : 'append';\n      }\n\n      return m.addMessages([messageToAdd], animate, method);\n    }\n  }, {\n    key: \"setScrollData\",\n    value: function setScrollData() {\n      var m = this; // Define scroll positions before new messages added\n\n      var scrollHeightBefore = m.pageContentEl.scrollHeight;\n      var heightBefore = m.pageContentEl.offsetHeight;\n      var scrollBefore = m.pageContentEl.scrollTop;\n      m.scrollData = {\n        scrollHeightBefore: scrollHeightBefore,\n        heightBefore: heightBefore,\n        scrollBefore: scrollBefore\n      };\n      return {\n        scrollHeightBefore: scrollHeightBefore,\n        heightBefore: heightBefore,\n        scrollBefore: scrollBefore\n      };\n    }\n  }, {\n    key: \"addMessages\",\n    value: function addMessages() {\n      var m = this;\n      var messagesToAdd;\n      var animate;\n      var method;\n\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      if (typeof args[1] === 'boolean') {\n        messagesToAdd = args[0];\n        animate = args[1];\n        method = args[2];\n      } else {\n        messagesToAdd = args[0];\n        method = args[1];\n        animate = args[2];\n      }\n\n      if (typeof animate === 'undefined') {\n        animate = true;\n      }\n\n      if (typeof method === 'undefined') {\n        method = m.params.newMessagesFirst ? 'prepend' : 'append';\n      }\n\n      var _m$setScrollData = m.setScrollData(),\n          scrollHeightBefore = _m$setScrollData.scrollHeightBefore,\n          scrollBefore = _m$setScrollData.scrollBefore; // Add message to DOM and data\n\n\n      var messagesHTML = '';\n      var typingMessage = m.messages.filter(function (el) {\n        return el.isTyping;\n      })[0];\n      messagesToAdd.forEach(function (messageToAdd) {\n        if (typingMessage) {\n          if (method === 'append') {\n            m.messages.splice(m.messages.indexOf(typingMessage), 0, messageToAdd);\n          } else {\n            m.messages.splice(m.messages.indexOf(typingMessage) + 1, 0, messageToAdd);\n          }\n        } else {\n          m.messages[method === 'append' ? 'push' : 'unshift'](messageToAdd);\n        }\n\n        messagesHTML += m.renderMessage(messageToAdd);\n      });\n      var $messagesEls = $(messagesHTML);\n\n      if (animate) {\n        if (method === 'append' && !m.params.newMessagesFirst) {\n          $messagesEls.addClass('message-appear-from-bottom');\n        }\n\n        if (method === 'prepend' && m.params.newMessagesFirst) {\n          $messagesEls.addClass('message-appear-from-top');\n        }\n      }\n\n      if (typingMessage) {\n        if (method === 'append') {\n          $messagesEls.insertBefore(m.$el.find('.message-typing'));\n        } else {\n          $messagesEls.insertAfter(m.$el.find('.message-typing'));\n        }\n      } else {\n        m.$el[method]($messagesEls);\n      } // Layout\n\n\n      if (m.params.autoLayout) m.layout();\n\n      if (method === 'prepend' && !typingMessage) {\n        m.pageContentEl.scrollTop = scrollBefore + (m.pageContentEl.scrollHeight - scrollHeightBefore);\n      }\n\n      if (m.params.scrollMessages && (method === 'append' && !m.params.newMessagesFirst || method === 'prepend' && m.params.newMessagesFirst && !typingMessage)) {\n        m.scrollWithEdgeCheck(animate);\n      }\n\n      return m;\n    }\n  }, {\n    key: \"showTyping\",\n    value: function showTyping(message) {\n      if (message === void 0) {\n        message = {};\n      }\n\n      var m = this;\n      var typingMessage = m.messages.filter(function (el) {\n        return el.isTyping;\n      })[0];\n\n      if (typingMessage) {\n        m.removeMessage(m.messages.indexOf(typingMessage));\n      }\n\n      m.addMessage(extend({\n        type: 'received',\n        isTyping: true\n      }, message));\n      return m;\n    }\n  }, {\n    key: \"hideTyping\",\n    value: function hideTyping() {\n      var m = this;\n      var typingMessageIndex;\n      var typingFound;\n      m.messages.forEach(function (message, index) {\n        if (message.isTyping) typingMessageIndex = index;\n      });\n\n      if (typeof typingMessageIndex !== 'undefined') {\n        if (m.$el.find('.message').eq(typingMessageIndex).hasClass('message-typing')) {\n          typingFound = true;\n          m.removeMessage(typingMessageIndex);\n        }\n      }\n\n      if (!typingFound) {\n        var $typingMessageEl = m.$el.find('.message-typing');\n\n        if ($typingMessageEl.length) {\n          m.removeMessage($typingMessageEl);\n        }\n      }\n\n      return m;\n    }\n  }, {\n    key: \"scrollWithEdgeCheck\",\n    value: function scrollWithEdgeCheck(animate) {\n      var m = this;\n      var _m$scrollData = m.scrollData,\n          scrollBefore = _m$scrollData.scrollBefore,\n          scrollHeightBefore = _m$scrollData.scrollHeightBefore,\n          heightBefore = _m$scrollData.heightBefore;\n\n      if (m.params.scrollMessagesOnEdge) {\n        var onEdge = false;\n\n        if (m.params.newMessagesFirst && scrollBefore === 0) {\n          onEdge = true;\n        }\n\n        if (!m.params.newMessagesFirst && scrollBefore - (scrollHeightBefore - heightBefore) >= -10) {\n          onEdge = true;\n        }\n\n        if (onEdge) m.scroll(animate ? undefined : 0);\n      } else {\n        m.scroll(animate ? undefined : 0);\n      }\n    }\n  }, {\n    key: \"scroll\",\n    value: function scroll(duration, scrollTop) {\n      if (duration === void 0) {\n        duration = 300;\n      }\n\n      var m = this;\n      var currentScroll = m.pageContentEl.scrollTop;\n      var newScrollTop;\n      if (typeof scrollTop !== 'undefined') newScrollTop = scrollTop;else {\n        newScrollTop = m.params.newMessagesFirst ? 0 : m.pageContentEl.scrollHeight - m.pageContentEl.offsetHeight;\n        if (newScrollTop === currentScroll) return m;\n      }\n      m.$pageContentEl.scrollTop(newScrollTop, duration);\n      return m;\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var m = this;\n\n      if (!m.messages || m.messages.length === 0) {\n        m.messages = m.getMessagesData();\n      }\n\n      if (m.params.messages && m.params.messages.length) {\n        m.renderMessages();\n      }\n\n      if (m.params.autoLayout) m.layout();\n      if (m.params.scrollMessages) m.scroll(0);\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      var m = this;\n      m.emit('local::beforeDestroy messagesBeforeDestroy', m);\n      m.$el.trigger('messages:beforedestroy');\n\n      if (m.$el[0]) {\n        m.$el[0].f7Messages = null;\n        delete m.$el[0].f7Messages;\n      }\n\n      deleteProps(m);\n    }\n  }]);\n\n  return Messages;\n}(Framework7Class);\n\nexport default Messages;","map":{"version":3,"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","$","extend","deleteProps","Framework7Class","$jsx","Messages","app","params","m","defaults","autoLayout","messages","newMessagesFirst","scrollMessages","scrollMessagesOnEdge","firstMessageRule","undefined","lastMessageRule","tailMessageRule","sameNameMessageRule","sameHeaderMessageRule","sameFooterMessageRule","sameAvatarMessageRule","customClassMessageRule","renderMessage","useModulesParams","$el","el","eq","f7Messages","$pageContentEl","closest","pageContentEl","useModules","init","messageEl","$messageEl","data","name","find","html","header","textHeader","textFooter","footer","isTitle","hasClass","type","text","image","imageSrc","attr","typing","replace","avatar","css","each","push","getMessageData","messageToRender","message","attrs","class","isTyping","cssClass","style","src","messagesToRender","method","map","join","index","getMessagesData","classes","previousMessage","nextMessage","isFirstMessage","isLastMessage","isTailMessage","isSameNameMessage","isSameHeaderMessage","isSameFooterMessage","isSameAvatarMessage","customMessageClasses","isCustomClassMessage","split","forEach","customClass","removeClass","className","addClass","messageToRemove","layout","indexOf","children","remove","splice","messagesToRemove","Array","isArray","messagesToRemoveEls","messageToRemoveIndex","removeMessage","messageToAdd","animate","_len","args","_key","addMessages","scrollHeightBefore","scrollHeight","heightBefore","offsetHeight","scrollBefore","scrollTop","scrollData","messagesToAdd","_len2","_key2","setScrollData","messagesHTML","typingMessage","filter","$messagesEls","insertBefore","insertAfter","scrollWithEdgeCheck","addMessage","typingMessageIndex","typingFound","$typingMessageEl","onEdge","scroll","duration","currentScroll","newScrollTop","renderMessages","emit","trigger"],"sources":["/root/Pokemon/ui/node_modules/framework7/components/messages/messages-class.js"],"sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport $ from '../../shared/dom7.js';\nimport { extend, deleteProps } from '../../shared/utils.js';\nimport Framework7Class from '../../shared/class.js';\n/** @jsx $jsx */\n\nimport $jsx from '../../shared/$jsx.js';\n\nclass Messages extends Framework7Class {\n  constructor(app, params) {\n    if (params === void 0) {\n      params = {};\n    }\n\n    super(params, [app]);\n    const m = this;\n    const defaults = {\n      autoLayout: true,\n      messages: [],\n      newMessagesFirst: false,\n      scrollMessages: true,\n      scrollMessagesOnEdge: true,\n      firstMessageRule: undefined,\n      lastMessageRule: undefined,\n      tailMessageRule: undefined,\n      sameNameMessageRule: undefined,\n      sameHeaderMessageRule: undefined,\n      sameFooterMessageRule: undefined,\n      sameAvatarMessageRule: undefined,\n      customClassMessageRule: undefined,\n      renderMessage: undefined\n    }; // Extend defaults with modules params\n\n    m.useModulesParams(defaults);\n    m.params = extend(defaults, params);\n    const $el = $(params.el).eq(0);\n    if ($el.length === 0) return m;\n    if ($el[0].f7Messages) return $el[0].f7Messages;\n    $el[0].f7Messages = m;\n    const $pageContentEl = $el.closest('.page-content').eq(0);\n    extend(m, {\n      messages: m.params.messages,\n      $el,\n      el: $el[0],\n      $pageContentEl,\n      pageContentEl: $pageContentEl[0]\n    }); // Install Modules\n\n    m.useModules(); // Init\n\n    m.init();\n    return m;\n  } // eslint-disable-next-line\n\n\n  getMessageData(messageEl) {\n    const $messageEl = $(messageEl);\n    const data = {\n      name: $messageEl.find('.message-name').html(),\n      header: $messageEl.find('.message-header').html(),\n      textHeader: $messageEl.find('.message-text-header').html(),\n      textFooter: $messageEl.find('.message-text-footer').html(),\n      footer: $messageEl.find('.message-footer').html(),\n      isTitle: $messageEl.hasClass('messages-title'),\n      type: $messageEl.hasClass('message-sent') ? 'sent' : 'received',\n      text: $messageEl.find('.message-text').html(),\n      image: $messageEl.find('.message-image').html(),\n      imageSrc: $messageEl.find('.message-image img').attr('src'),\n      typing: $messageEl.hasClass('message-typing')\n    };\n\n    if (data.isTitle) {\n      data.text = $messageEl.html();\n    }\n\n    if (data.text && data.textHeader) {\n      data.text = data.text.replace(`<div class=\"message-text-header\">${data.textHeader}</div>`, '');\n    }\n\n    if (data.text && data.textFooter) {\n      data.text = data.text.replace(`<div class=\"message-text-footer\">${data.textFooter}</div>`, '');\n    }\n\n    let avatar = $messageEl.find('.message-avatar').css('background-image');\n    if (avatar === 'none' || avatar === '') avatar = undefined;\n\n    if (avatar && typeof avatar === 'string') {\n      avatar = avatar.replace('url(', '').replace(')', '').replace(/\"/g, '').replace(/'/g, '');\n    } else {\n      avatar = undefined;\n    }\n\n    data.avatar = avatar;\n    return data;\n  }\n\n  getMessagesData() {\n    const m = this;\n    const data = [];\n    m.$el.find('.message, .messages-title').each(messageEl => {\n      data.push(m.getMessageData(messageEl));\n    });\n    return data;\n  }\n\n  renderMessage(messageToRender) {\n    const m = this;\n    const message = extend({\n      type: 'sent',\n      attrs: {}\n    }, messageToRender);\n\n    if (m.params.renderMessage) {\n      return m.params.renderMessage.call(m, message);\n    }\n\n    if (message.isTitle) {\n      return `<div class=\"messages-title\">${message.text}</div>`;\n    }\n\n    return $jsx(\"div\", _extends({\n      class: `message message-${message.type} ${message.isTyping ? 'message-typing' : ''} ${message.cssClass || ''}`\n    }, message.attrs), message.avatar && $jsx(\"div\", {\n      class: \"message-avatar\",\n      style: `background-image:url(${message.avatar})`\n    }), $jsx(\"div\", {\n      class: \"message-content\"\n    }, message.name && $jsx(\"div\", {\n      class: \"message-name\"\n    }, message.name), message.header && $jsx(\"div\", {\n      class: \"message-header\"\n    }, message.header), $jsx(\"div\", {\n      class: \"message-bubble\"\n    }, message.textHeader && $jsx(\"div\", {\n      class: \"message-text-header\"\n    }, message.textHeader), message.image && $jsx(\"div\", {\n      class: \"message-image\"\n    }, message.image), message.imageSrc && !message.image && $jsx(\"div\", {\n      class: \"message-image\"\n    }, $jsx(\"img\", {\n      src: message.imageSrc\n    })), (message.text || message.isTyping) && $jsx(\"div\", {\n      class: \"message-text\"\n    }, message.text || '', message.isTyping && $jsx(\"div\", {\n      class: \"message-typing-indicator\"\n    }, $jsx(\"div\", null), $jsx(\"div\", null), $jsx(\"div\", null))), message.textFooter && $jsx(\"div\", {\n      class: \"message-text-footer\"\n    }, message.textFooter)), message.footer && $jsx(\"div\", {\n      class: \"message-footer\"\n    }, message.footer)));\n  }\n\n  renderMessages(messagesToRender, method) {\n    if (messagesToRender === void 0) {\n      messagesToRender = this.messages;\n    }\n\n    if (method === void 0) {\n      method = this.params.newMessagesFirst ? 'prepend' : 'append';\n    }\n\n    const m = this;\n    const html = messagesToRender.map(message => m.renderMessage(message)).join('');\n    m.$el[method](html);\n  }\n\n  isFirstMessage() {\n    const m = this;\n    if (m.params.firstMessageRule) return m.params.firstMessageRule(...arguments);\n    return false;\n  }\n\n  isLastMessage() {\n    const m = this;\n    if (m.params.lastMessageRule) return m.params.lastMessageRule(...arguments);\n    return false;\n  }\n\n  isTailMessage() {\n    const m = this;\n    if (m.params.tailMessageRule) return m.params.tailMessageRule(...arguments);\n    return false;\n  }\n\n  isSameNameMessage() {\n    const m = this;\n    if (m.params.sameNameMessageRule) return m.params.sameNameMessageRule(...arguments);\n    return false;\n  }\n\n  isSameHeaderMessage() {\n    const m = this;\n    if (m.params.sameHeaderMessageRule) return m.params.sameHeaderMessageRule(...arguments);\n    return false;\n  }\n\n  isSameFooterMessage() {\n    const m = this;\n    if (m.params.sameFooterMessageRule) return m.params.sameFooterMessageRule(...arguments);\n    return false;\n  }\n\n  isSameAvatarMessage() {\n    const m = this;\n    if (m.params.sameAvatarMessageRule) return m.params.sameAvatarMessageRule(...arguments);\n    return false;\n  }\n\n  isCustomClassMessage() {\n    const m = this;\n    if (m.params.customClassMessageRule) return m.params.customClassMessageRule(...arguments);\n    return undefined;\n  }\n\n  layout() {\n    const m = this;\n    m.$el.find('.message, .messages-title').each((messageEl, index) => {\n      const $messageEl = $(messageEl);\n\n      if (!m.messages) {\n        m.messages = m.getMessagesData();\n      }\n\n      const classes = [];\n      const message = m.messages[index];\n      const previousMessage = m.messages[index - 1];\n      const nextMessage = m.messages[index + 1];\n\n      if (m.isFirstMessage(message, previousMessage, nextMessage)) {\n        classes.push('message-first');\n      }\n\n      if (m.isLastMessage(message, previousMessage, nextMessage)) {\n        classes.push('message-last');\n      }\n\n      if (m.isTailMessage(message, previousMessage, nextMessage)) {\n        classes.push('message-tail');\n      }\n\n      if (m.isSameNameMessage(message, previousMessage, nextMessage)) {\n        classes.push('message-same-name');\n      }\n\n      if (m.isSameHeaderMessage(message, previousMessage, nextMessage)) {\n        classes.push('message-same-header');\n      }\n\n      if (m.isSameFooterMessage(message, previousMessage, nextMessage)) {\n        classes.push('message-same-footer');\n      }\n\n      if (m.isSameAvatarMessage(message, previousMessage, nextMessage)) {\n        classes.push('message-same-avatar');\n      }\n\n      let customMessageClasses = m.isCustomClassMessage(message, previousMessage, nextMessage);\n\n      if (customMessageClasses && customMessageClasses.length) {\n        if (typeof customMessageClasses === 'string') {\n          customMessageClasses = customMessageClasses.split(' ');\n        }\n\n        customMessageClasses.forEach(customClass => {\n          classes.push(customClass);\n        });\n      }\n\n      $messageEl.removeClass('message-first message-last message-tail message-same-name message-same-header message-same-footer message-same-avatar');\n      classes.forEach(className => {\n        $messageEl.addClass(className);\n      });\n    });\n  }\n\n  clear() {\n    const m = this;\n    m.messages = [];\n    m.$el.html('');\n  }\n\n  removeMessage(messageToRemove, layout) {\n    if (layout === void 0) {\n      layout = true;\n    }\n\n    const m = this; // Index or El\n\n    let index;\n    let $el;\n\n    if (typeof messageToRemove === 'number') {\n      index = messageToRemove;\n      $el = m.$el.find('.message, .messages-title').eq(index);\n    } else if (m.messages && m.messages.indexOf(messageToRemove) >= 0) {\n      index = m.messages.indexOf(messageToRemove);\n      $el = m.$el.children().eq(index);\n    } else {\n      $el = $(messageToRemove);\n      index = $el.index();\n    }\n\n    if ($el.length === 0) {\n      return m;\n    }\n\n    $el.remove();\n    m.messages.splice(index, 1);\n    if (m.params.autoLayout && layout) m.layout();\n    return m;\n  }\n\n  removeMessages(messagesToRemove, layout) {\n    if (layout === void 0) {\n      layout = true;\n    }\n\n    const m = this;\n\n    if (Array.isArray(messagesToRemove)) {\n      const messagesToRemoveEls = [];\n      messagesToRemove.forEach(messageToRemoveIndex => {\n        messagesToRemoveEls.push(m.$el.find('.message, .messages-title').eq(messageToRemoveIndex));\n      });\n      messagesToRemoveEls.forEach(messageToRemove => {\n        m.removeMessage(messageToRemove, false);\n      });\n    } else {\n      $(messagesToRemove).each(messageToRemove => {\n        m.removeMessage(messageToRemove, false);\n      });\n    }\n\n    if (m.params.autoLayout && layout) m.layout();\n    return m;\n  }\n\n  addMessage() {\n    const m = this;\n    let messageToAdd;\n    let animate;\n    let method;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    if (typeof args[1] === 'boolean') {\n      [messageToAdd, animate, method] = args;\n    } else {\n      [messageToAdd, method, animate] = args;\n    }\n\n    if (typeof animate === 'undefined') {\n      animate = true;\n    }\n\n    if (typeof method === 'undefined') {\n      method = m.params.newMessagesFirst ? 'prepend' : 'append';\n    }\n\n    return m.addMessages([messageToAdd], animate, method);\n  }\n\n  setScrollData() {\n    const m = this; // Define scroll positions before new messages added\n\n    const scrollHeightBefore = m.pageContentEl.scrollHeight;\n    const heightBefore = m.pageContentEl.offsetHeight;\n    const scrollBefore = m.pageContentEl.scrollTop;\n    m.scrollData = {\n      scrollHeightBefore,\n      heightBefore,\n      scrollBefore\n    };\n    return {\n      scrollHeightBefore,\n      heightBefore,\n      scrollBefore\n    };\n  }\n\n  addMessages() {\n    const m = this;\n    let messagesToAdd;\n    let animate;\n    let method;\n\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    if (typeof args[1] === 'boolean') {\n      [messagesToAdd, animate, method] = args;\n    } else {\n      [messagesToAdd, method, animate] = args;\n    }\n\n    if (typeof animate === 'undefined') {\n      animate = true;\n    }\n\n    if (typeof method === 'undefined') {\n      method = m.params.newMessagesFirst ? 'prepend' : 'append';\n    }\n\n    const {\n      scrollHeightBefore,\n      scrollBefore\n    } = m.setScrollData(); // Add message to DOM and data\n\n    let messagesHTML = '';\n    const typingMessage = m.messages.filter(el => el.isTyping)[0];\n    messagesToAdd.forEach(messageToAdd => {\n      if (typingMessage) {\n        if (method === 'append') {\n          m.messages.splice(m.messages.indexOf(typingMessage), 0, messageToAdd);\n        } else {\n          m.messages.splice(m.messages.indexOf(typingMessage) + 1, 0, messageToAdd);\n        }\n      } else {\n        m.messages[method === 'append' ? 'push' : 'unshift'](messageToAdd);\n      }\n\n      messagesHTML += m.renderMessage(messageToAdd);\n    });\n    const $messagesEls = $(messagesHTML);\n\n    if (animate) {\n      if (method === 'append' && !m.params.newMessagesFirst) {\n        $messagesEls.addClass('message-appear-from-bottom');\n      }\n\n      if (method === 'prepend' && m.params.newMessagesFirst) {\n        $messagesEls.addClass('message-appear-from-top');\n      }\n    }\n\n    if (typingMessage) {\n      if (method === 'append') {\n        $messagesEls.insertBefore(m.$el.find('.message-typing'));\n      } else {\n        $messagesEls.insertAfter(m.$el.find('.message-typing'));\n      }\n    } else {\n      m.$el[method]($messagesEls);\n    } // Layout\n\n\n    if (m.params.autoLayout) m.layout();\n\n    if (method === 'prepend' && !typingMessage) {\n      m.pageContentEl.scrollTop = scrollBefore + (m.pageContentEl.scrollHeight - scrollHeightBefore);\n    }\n\n    if (m.params.scrollMessages && (method === 'append' && !m.params.newMessagesFirst || method === 'prepend' && m.params.newMessagesFirst && !typingMessage)) {\n      m.scrollWithEdgeCheck(animate);\n    }\n\n    return m;\n  }\n\n  showTyping(message) {\n    if (message === void 0) {\n      message = {};\n    }\n\n    const m = this;\n    const typingMessage = m.messages.filter(el => el.isTyping)[0];\n\n    if (typingMessage) {\n      m.removeMessage(m.messages.indexOf(typingMessage));\n    }\n\n    m.addMessage(extend({\n      type: 'received',\n      isTyping: true\n    }, message));\n    return m;\n  }\n\n  hideTyping() {\n    const m = this;\n    let typingMessageIndex;\n    let typingFound;\n    m.messages.forEach((message, index) => {\n      if (message.isTyping) typingMessageIndex = index;\n    });\n\n    if (typeof typingMessageIndex !== 'undefined') {\n      if (m.$el.find('.message').eq(typingMessageIndex).hasClass('message-typing')) {\n        typingFound = true;\n        m.removeMessage(typingMessageIndex);\n      }\n    }\n\n    if (!typingFound) {\n      const $typingMessageEl = m.$el.find('.message-typing');\n\n      if ($typingMessageEl.length) {\n        m.removeMessage($typingMessageEl);\n      }\n    }\n\n    return m;\n  }\n\n  scrollWithEdgeCheck(animate) {\n    const m = this;\n    const {\n      scrollBefore,\n      scrollHeightBefore,\n      heightBefore\n    } = m.scrollData;\n\n    if (m.params.scrollMessagesOnEdge) {\n      let onEdge = false;\n\n      if (m.params.newMessagesFirst && scrollBefore === 0) {\n        onEdge = true;\n      }\n\n      if (!m.params.newMessagesFirst && scrollBefore - (scrollHeightBefore - heightBefore) >= -10) {\n        onEdge = true;\n      }\n\n      if (onEdge) m.scroll(animate ? undefined : 0);\n    } else {\n      m.scroll(animate ? undefined : 0);\n    }\n  }\n\n  scroll(duration, scrollTop) {\n    if (duration === void 0) {\n      duration = 300;\n    }\n\n    const m = this;\n    const currentScroll = m.pageContentEl.scrollTop;\n    let newScrollTop;\n    if (typeof scrollTop !== 'undefined') newScrollTop = scrollTop;else {\n      newScrollTop = m.params.newMessagesFirst ? 0 : m.pageContentEl.scrollHeight - m.pageContentEl.offsetHeight;\n      if (newScrollTop === currentScroll) return m;\n    }\n    m.$pageContentEl.scrollTop(newScrollTop, duration);\n    return m;\n  }\n\n  init() {\n    const m = this;\n\n    if (!m.messages || m.messages.length === 0) {\n      m.messages = m.getMessagesData();\n    }\n\n    if (m.params.messages && m.params.messages.length) {\n      m.renderMessages();\n    }\n\n    if (m.params.autoLayout) m.layout();\n    if (m.params.scrollMessages) m.scroll(0);\n  }\n\n  destroy() {\n    const m = this;\n    m.emit('local::beforeDestroy messagesBeforeDestroy', m);\n    m.$el.trigger('messages:beforedestroy');\n\n    if (m.$el[0]) {\n      m.$el[0].f7Messages = null;\n      delete m.$el[0].f7Messages;\n    }\n\n    deleteProps(m);\n  }\n\n}\n\nexport default Messages;"],"mappings":"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"},"metadata":{},"sourceType":"module"}